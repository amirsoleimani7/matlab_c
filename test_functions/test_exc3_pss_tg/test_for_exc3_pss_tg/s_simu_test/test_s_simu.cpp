#include "H_header.h"

using namespace Eigen;
using namespace std;

int main(){

    MatrixXd bus(13, 14);

    bus << 1, 1.0100, 18.5000, 7.2615, 1.2740, 0.0000, 0.0000, 0.0000, 0.0000, 1.0000, 5.0000, -2.0000, 22.0000, 1.1000,
           2, 1.0100, 7.7250, 7.0000, 1.9480, 0.0000, 0.0000, 0.0000, 0.0000, 2.0000, 5.0000, -2.0000, 22.0000, 1.1000,
           3, 0.9791, -7.4410, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.0000, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000,
           4, 0.9980, -10.2320, 0.0000, 0.0000, 9.7600, 1.0000, 0.0000, 0.0000, 3.0000, 0.0000, 0.0000, 115.0000, 1.0500,
           5, 0.9962, 11.5780, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000,
           6, 1.0100, -9.0124, 7.0000, 1.1430, 0.0000, 0.0000, 0.0000, 0.0000, 2.0000, 5.0000, -2.0000, 22.0000, 1.1000,
           7, 1.0100, -19.1200, 7.0000, 1.7840, 0.0000, 0.0000, 0.0000, 0.0000, 2.0000, 5.0000, -2.0000, 22.0000, 1.1000,
           8, 0.9863, -34.0630, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 5.0000, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000,
           9, 1.0062, -39.0200, 0.0000, 0.0000, 17.6500, 1.0000, 0.0000, 0.0000, 3.0000, 0.0000, 0.0000, 115.0000, 1.0500,
           10, 0.9847, 0.9748, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000,
           11, 1.0003, -21.0540, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 1.2700, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000,
           12, 0.9980, -15.6900, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000,
           13, 0.9877, -25.8700, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.0000, 0.0000, 0.0000, 230.0000, 1.5000;

    cout << "bus is : \n" << bus << "\n";




    MatrixXd line(14, 10);
    line << 1.0000, 5.0000, 0.0000, 0.0167, 0.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            2.0000, 10.0000, 0.0000, 0.0167, 0.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            3.0000, 4.0000, 0.0000, 0.0050, 0.0000, 0.9750, 0.0000, 1.2000, 0.8000, 0.0063,
            3.0000, 10.0000, 0.0010, 0.0100, 0.0175, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            3.0000, 11.0000, 0.0110, 0.1100, 0.1925, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            3.0000, 11.0000, 0.0110, 0.1100, 0.1925, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            5.0000, 10.0000, 0.0025, 0.0250, 0.0437, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            6.0000, 12.0000, 0.0000, 0.0167, 0.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            7.0000, 13.0000, 0.0000, 0.0167, 0.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            8.0000, 11.0000, 0.0110, 0.1100, 0.1925, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            8.0000, 11.0000, 0.0110, 0.1100, 0.1925, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            8.0000, 9.0000, 0.0000, 0.0050, 0.0000, 0.9688, 0.0000, 1.2000, 0.8000, 0.0063,
            8.0000, 13.0000, 0.0010, 0.0100, 0.0175, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000,
            12.0000, 13.0000, 0.0025, 0.0250, 0.0437, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000;

    cout << "line is : \n" << line << "\n";

    MatrixXd mac_con(4, 21);
    mac_con << 1.0000, 1.0000, 900.0000, 0.2000, 0.0000, 1.8000, 0.3000, 0.2500, 8.0000, 0.0300, 1.7000, 0.5500, 0.2400, 0.4000, 0.0500, 6.5000, 0.0000, 0.0000, 1.0000, 0.0654, 0.5743,
            2.0000, 2.0000, 900.0000, 0.2000, 0.0000, 1.8000, 0.3000, 0.2500, 8.0000, 0.0300, 1.7000, 0.5500, 0.2500, 0.4000, 0.0500, 6.5000, 0.0000, 0.0000, 2.0000, 0.0654, 0.5743,
            3.0000, 6.0000, 900.0000, 0.2000, 0.0000, 1.8000, 0.3000, 0.2500, 8.0000, 0.0300, 1.7000, 0.5500, 0.2400, 0.4000, 0.0500, 6.5000, 0.0000, 0.0000, 3.0000, 0.0654, 0.5743,
            4.0000, 7.0000, 900.0000, 0.2000, 0.0000, 1.8000, 0.3000, 0.2500, 8.0000, 0.0300, 1.7000, 0.5500, 0.2500, 0.4000, 0.0500, 6.5000, 0.0000, 0.0000, 4.0000, 0.0654, 0.5743;



    cout << "mac_con is : \n" << mac_con << "\n";


    MatrixXd load_con(2, 5);
    load_con << 4.0000, 0.0000, 0.0000, 0.5000, 0.0000,
                9.0000, 0.0000, 0.0000, 0.5000, 0.0000;


    cout  << "load_con is : \n" << load_con << "\n";

    MatrixXd exc_con(4, 20);
    
    exc_con << 3.0000, 1.0000, 0.0000, 7.0400, 0.4000, 6.6700, 1.0000, 7.5700, 0.0000, 0.2000, -0.2000, 200.0000, 4.3650, 20.0000, 4.8300, 0.0910, 1.0960, 6.5300, 1.0000, 6.5300,
                3.0000, 2.0000, 0.0000, 7.0400, 0.4000, 6.6700, 1.0000, 7.5700, 0.0000, 0.2000, -0.2000, 200.0000, 4.3650, 20.0000, 4.8300, 0.0910, 1.0960, 6.5300, 1.0000, 6.5300,
                3.0000, 3.0000, 0.0000, 7.0400, 0.4000, 6.6700, 1.0000, 7.5700, 0.0000, 0.2000, -0.2000, 200.0000, 4.3650, 20.0000, 4.8300, 0.0910, 1.0960, 6.5300, 1.0000, 6.5300,
                3.0000, 4.0000, 0.0000, 7.0400, 0.4000, 6.6700, 1.0000, 7.5700, 0.0000, 0.2000, -0.2000, 200.0000, 4.3650, 20.0000, 4.8300, 0.0910, 1.0960, 6.5300, 1.0000, 6.5300;


    cout << "exc_con is : \n" << exc_con << "\n";

    MatrixXd pss_con(4, 10);
    pss_con << 1.0000, 1.0000, 100.0000, 10.0000, 0.0500, 0.0100, 0.0500, 0.0100, 0.2000, -0.0500,
            1.0000, 2.0000, 100.0000, 10.0000, 0.0500, 0.0100, 0.0500, 0.0100, 0.2000, -0.0500,
            1.0000, 3.0000, 100.0000, 10.0000, 0.0500, 0.0100, 0.0500, 0.0100, 0.2000, -0.0500,
            1.0000, 4.0000, 100.0000, 10.0000, 0.0500, 0.0100, 0.0500, 0.0100, 0.2000, -0.0500;

    cout << "pss_con is : \n" << pss_con << "\n";


    MatrixXd tg_con(4, 10);
    tg_con << 1.0000, 1.0000, 1.0000, 25.0000, 1.0000, 0.1000, 0.5000, 0.0000, 1.2500, 5.0000,
            1.0000, 2.0000, 1.0000, 25.0000, 1.0000, 0.1000, 0.5000, 0.0000, 1.2500, 5.0000,
            1.0000, 3.0000, 1.0000, 25.0000, 1.0000, 0.1000, 0.5000, 0.0000, 1.2500, 5.0000,
            1.0000, 4.0000, 1.0000, 25.0000, 1.0000, 0.1000, 0.5000, 0.0000, 1.2500, 5.0000;


    cout << "tg_con is : \n" << tg_con << "\n";

    MatrixXd sw_con(7, 7);
    sw_con << 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0100,
            0.1000, 3.0000, 11.0000, 0.0000, 0.0000, 7.0000, 0.0100,
            0.1500, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0100,
            0.2000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0100,
            0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0100,
            1.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0100,
            5.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000;

    cout << "sw_con is : \n" <<  sw_con << "\n";
    
    s_simu(bus, line,mac_con , load_con , exc_con , pss_con , tg_con , sw_con);

    return 0;
}