#include "H_header.h"

using namespace std;


int main(){

        Eigen::MatrixXd line(14, 10);

        line << 1, 5, 0, 0.0167, 0, 1, 0, 0, 0, 0,
                2, 10, 0, 0.0167, 0, 1, 0, 0, 0, 0,
                3, 4, 0, 0.005, 0, 1, 0, 1.2, 0.8, 0.02,
                3, 10, 0.001, 0.01, 0.0175, 1, 0, 0, 0, 0,
                3, 11, 0.011, 0.11, 0.1925, 1, 0, 0, 0, 0,
                3, 11, 0.011, 0.11, 0.1925, 1, 0, 0, 0, 0,
                5, 10, 0.0025, 0.025, 0.0437, 1, 0, 0, 0, 0,
                6, 12, 0, 0.0167, 0, 1, 0, 0, 0, 0,
                7, 13, 0, 0.0167, 0, 1, 0, 0, 0, 0,
                8, 11, 0.011, 0.11, 0.1925, 1, 0, 0, 0, 0,
                8, 11, 0.011, 0.11, 0.1925, 1, 0, 0, 0, 0,
                8, 9, 0, 0.005, 0, 1, 0, 1.2, 0.8, 0.02,
                8, 13, 0.001, 0.01, 0.0175, 1, 0, 0, 0, 0,
                12, 13, 0.0025, 0.025, 0.0437, 1, 0, 0, 0, 0;

        std::cout << "line matrix:\n" << line << std::endl;

        Eigen::MatrixXd bus(13, 15);    

        bus <<  1, 1.03, 18.5, 7, 1.61, 0, 0, 0, 0, 1, 5, -1, 22, 1.1, 0.9,
                2, 1.01, 8.8, 7, 1.76, 0, 0, 0, 0, 2, 5, -1, 22, 1.1, 0.9,
                3, 0.9781, -6.1, 0, 0, 0, 0, 0, 3, 3, 9999, -9999, 230, 1.5, 0.5,
                4, 0.95, -10, 0, 0, 9.76, 1, 0, 0, 3, 9999, -9999, 115, 1.05, 0.95,
                5, 1.0103, 12.1, 0, 0, 0, 0, 0, 0, 3, 9999, -9999, 230, 1.5, 0.5,
                6, 1.03, -6.8, 7.16, 1.49, 0, 0, 0, 0, 2, 5, -1, 22, 1.1, 0.9,
                7, 1.01, -16.9, 7, 1.39, 0, 0, 0, 0, 2, 5, -1, 22, 1.1, 0.9,
                8, 0.9899, -31.8, 0, 0, 0, 0, 0, 5, 3, 9999, -9999, 230, 1.5, 0.5,
                9, 0.95, -35, 0, 0, 17.65, 1, 0, 0, 3, 9999, -9999, 115, 0.97 , 0.95,
                10, 0.9876, 2.1, 0, 0, 0, 0, 0, 0 , 3, 9999, -9999, 230, 1.5, 0.5,
                11, 1, -19.3, 0, 0, 0, 0, 0, 2, 3, 2, -9999, 500, 1.5, 0.5,
                12, 1.0125, -13.4, 0, 0, 0, 0, 0, 0, 3, 9999, -9999, 230, 1.5, 0.5,
                13, 0.9938, -23.6, 0, 0, 0, 0, 0, 0, 3, 9999, -9999, 230, 1.5, 0.5;

        std::cout << "bus Matrix:\n" << bus << std::endl;

        
        double tol = 0.000000001;
        double iter_max = 30;
        double acc = 1;
        string display = "nprime";
        double flag = 1;
        load_flow(bus,line,tol,iter_max,acc,display,flag);
}