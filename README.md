a matlab to cpp conversion ...
